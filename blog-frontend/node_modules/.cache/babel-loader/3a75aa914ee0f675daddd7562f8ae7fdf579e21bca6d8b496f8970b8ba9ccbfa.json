{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useUserStore } from '@/store/user';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { ArrowLeft, Edit, Delete, User, Calendar, View, Picture } from '@element-plus/icons-vue';\nimport { getArticleById, deleteArticle } from '@/api/article';\nimport { marked } from 'marked';\nimport DOMPurify from 'dompurify';\nexport default {\n  __name: 'ArticleContentView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n    const userStore = useUserStore();\n    const article = ref({});\n    const loading = ref(false);\n    const isAuthor = computed(() => {\n      return userStore.userInfo && article.value.authorId === userStore.userInfo.id;\n    });\n    const renderedContent = computed(() => {\n      if (!article.value.content) return '';\n      const rawHtml = marked(article.value.content);\n      return DOMPurify.sanitize(rawHtml);\n    });\n    const loadArticle = async () => {\n      try {\n        loading.value = true;\n        const result = await getArticleById(route.params.id);\n        if (result.code === 200) {\n          article.value = result.data;\n          console.log('获取文章:', article.value);\n        } else {\n          ElMessage.error(result.message || '获取文章失败');\n          router.push('/articles');\n        }\n      } catch (error) {\n        console.error('获取文章失败:', error);\n        ElMessage.error('获取文章失败');\n        router.push('/articles');\n      } finally {\n        loading.value = false;\n      }\n    };\n    const formatDate = date => {\n      if (!date) return '';\n      return new Date(date).toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    };\n    const goBack = () => {\n      router.push('/articles');\n    };\n    const goToEdit = () => {\n      router.push(`/article/edit/${article.value.id}`);\n    };\n    const handleDelete = async () => {\n      try {\n        await ElMessageBox.confirm('确定要删除这篇文章吗？此操作不可恢复。', '警告', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        });\n        const result = await deleteArticle(article.value.id);\n        if (result.code === 200) {\n          ElMessage.success('删除成功');\n          router.push('/articles');\n        } else {\n          ElMessage.error(result.message || '删除失败');\n        }\n      } catch (error) {\n        if (error !== 'cancel') {\n          console.error('删除文章失败:', error);\n          ElMessage.error('删除失败');\n        }\n      }\n    };\n    onMounted(() => {\n      loadArticle();\n    });\n    const __returned__ = {\n      route,\n      router,\n      userStore,\n      article,\n      loading,\n      isAuthor,\n      renderedContent,\n      loadArticle,\n      formatDate,\n      goBack,\n      goToEdit,\n      handleDelete,\n      ref,\n      onMounted,\n      computed,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get useUserStore() {\n        return useUserStore;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get ElMessageBox() {\n        return ElMessageBox;\n      },\n      get ArrowLeft() {\n        return ArrowLeft;\n      },\n      get Edit() {\n        return Edit;\n      },\n      get Delete() {\n        return Delete;\n      },\n      get User() {\n        return User;\n      },\n      get Calendar() {\n        return Calendar;\n      },\n      get View() {\n        return View;\n      },\n      get Picture() {\n        return Picture;\n      },\n      get getArticleById() {\n        return getArticleById;\n      },\n      get deleteArticle() {\n        return deleteArticle;\n      },\n      get marked() {\n        return marked;\n      },\n      get DOMPurify() {\n        return DOMPurify;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","useRoute","useRouter","useUserStore","ElMessage","ElMessageBox","ArrowLeft","Edit","Delete","User","Calendar","View","Picture","getArticleById","deleteArticle","marked","DOMPurify","route","router","userStore","article","loading","isAuthor","userInfo","value","authorId","id","renderedContent","content","rawHtml","sanitize","loadArticle","result","params","code","data","console","log","error","message","push","formatDate","date","Date","toLocaleDateString","year","month","day","hour","minute","goBack","goToEdit","handleDelete","confirm","confirmButtonText","cancelButtonText","type","success"],"sources":["C:/Users/52291/Desktop/test/blog/blog/blog-frontend/src/views/article/ArticleContentView.vue"],"sourcesContent":["<template>\r\n  <div class=\"article-content-container\">\r\n    <div class=\"article-header\">\r\n      <div class=\"back-button\" @click=\"goBack\">\r\n        <el-icon><ArrowLeft /></el-icon>\r\n        返回列表\r\n      </div>\r\n      <div class=\"article-actions\" v-if=\"isAuthor\">\r\n        <el-button type=\"primary\" @click=\"goToEdit\">\r\n          <el-icon><Edit /></el-icon>\r\n          编辑文章\r\n        </el-button>\r\n        <el-button type=\"danger\" @click=\"handleDelete\">\r\n          <el-icon><Delete /></el-icon>\r\n          删除文章\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"article-main\">\r\n      <h1 class=\"article-title\">{{ article.title }}</h1>\r\n      \r\n      <div class=\"article-meta\">\r\n        <span class=\"meta-item\">\r\n          <el-icon><User /></el-icon>\r\n          {{ article.author?.username || '未知作者' }}\r\n        </span>\r\n        <span class=\"meta-item\">\r\n          <el-icon><Calendar /></el-icon>\r\n          {{ formatDate(article.createTime) }}\r\n        </span>\r\n        <span class=\"meta-item\">\r\n          <el-icon><View /></el-icon>\r\n          {{ article.viewCount || 0 }} 阅读\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"article-cover\" v-if=\"article.coverImage\">\r\n        <el-image \r\n          :src=\"'http://localhost8082/'+article.coverImage\" \r\n          fit=\"cover\"\r\n          :preview-src-list=\"[article.coverImage]\"\r\n        >\r\n          <template #error>\r\n            <div class=\"image-placeholder\">\r\n              <el-icon><Picture /></el-icon>\r\n            </div>\r\n          </template>\r\n        </el-image>\r\n      </div>\r\n\r\n      <div class=\"article-body markdown-body\" v-html=\"renderedContent\"></div>\r\n    </div>\r\n\r\n    <div class=\"article-footer\">\r\n      <div class=\"article-tags\" v-if=\"article.tags && article.tags.length\">\r\n        <el-tag \r\n          v-for=\"tag in article.tags\" \r\n          :key=\"tag.id\"\r\n          class=\"tag\"\r\n        >\r\n          {{ tag.name }}\r\n        </el-tag>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"ArticleContentView\">\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useUserStore } from '@/store/user'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { ArrowLeft, Edit, Delete, User, Calendar, View, Picture } from '@element-plus/icons-vue'\r\nimport { getArticleById, deleteArticle } from '@/api/article'\r\nimport { marked } from 'marked'\r\nimport DOMPurify from 'dompurify'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst userStore = useUserStore()\r\n\r\nconst article = ref({})\r\nconst loading = ref(false)\r\n\r\nconst isAuthor = computed(() => {\r\n  return userStore.userInfo && article.value.authorId === userStore.userInfo.id\r\n})\r\n\r\nconst renderedContent = computed(() => {\r\n  if (!article.value.content) return ''\r\n  const rawHtml = marked(article.value.content)\r\n  return DOMPurify.sanitize(rawHtml)\r\n})\r\n\r\nconst loadArticle = async () => {\r\n  try {\r\n    loading.value = true\r\n    const result = await getArticleById(route.params.id)\r\n    if (result.code === 200) {\r\n      article.value = result.data\r\n      console.log('获取文章:', article.value)\r\n    } \r\n    else {\r\n      ElMessage.error(result.message || '获取文章失败')\r\n      router.push('/articles')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取文章失败:', error)\r\n    ElMessage.error('获取文章失败')\r\n    router.push('/articles')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst formatDate = (date) => {\r\n  if (!date) return ''\r\n  return new Date(date).toLocaleDateString('zh-CN', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  })\r\n}\r\n\r\nconst goBack = () => {\r\n  router.push('/articles')\r\n}\r\n\r\nconst goToEdit = () => {\r\n  router.push(`/article/edit/${article.value.id}`)\r\n}\r\n\r\nconst handleDelete = async () => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      '确定要删除这篇文章吗？此操作不可恢复。',\r\n      '警告',\r\n      {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n    )\r\n    \r\n    const result = await deleteArticle(article.value.id)\r\n    if (result.code === 200) {\r\n      ElMessage.success('删除成功')\r\n      router.push('/articles')\r\n    } else {\r\n      ElMessage.error(result.message || '删除失败')\r\n    }\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      console.error('删除文章失败:', error)\r\n      ElMessage.error('删除失败')\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  loadArticle()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.article-content-container {\r\n  max-width: 900px;\r\n  margin: 40px auto;\r\n  padding: 0 20px;\r\n}\r\n\r\n.article-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.back-button {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  color: #666;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: color 0.3s;\r\n}\r\n\r\n.back-button:hover {\r\n  color: #6e8efb;\r\n}\r\n\r\n.article-actions {\r\n  display: flex;\r\n  gap: 12px;\r\n}\r\n\r\n.article-main {\r\n  background: white;\r\n  border-radius: 12px;\r\n  padding: 40px;\r\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.article-title {\r\n  font-size: 32px;\r\n  font-weight: 700;\r\n  color: #333;\r\n  margin-bottom: 20px;\r\n  line-height: 1.4;\r\n}\r\n\r\n.article-meta {\r\n  display: flex;\r\n  gap: 20px;\r\n  margin-bottom: 30px;\r\n  color: #666;\r\n  font-size: 14px;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n}\r\n\r\n.article-cover {\r\n  margin: 30px -40px;\r\n  height: 400px;\r\n  overflow: hidden;\r\n}\r\n\r\n.article-cover .el-image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.image-placeholder {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #f5f7fa;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #909399;\r\n  font-size: 48px;\r\n}\r\n\r\n.article-body {\r\n  margin-top: 40px;\r\n  line-height: 1.8;\r\n  color: #333;\r\n}\r\n\r\n.article-footer {\r\n  margin-top: 40px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.article-tags {\r\n  display: flex;\r\n  gap: 8px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.tag {\r\n  background: #f5f7fa;\r\n  border: none;\r\n  color: #666;\r\n}\r\n\r\n:deep(.el-button--primary) {\r\n  background: #6e8efb;\r\n  border-color: #6e8efb;\r\n}\r\n\r\n:deep(.el-button--primary:hover) {\r\n  background: #5a7de0;\r\n  border-color: #5a7de0;\r\n}\r\n\r\n:deep(.el-button--danger) {\r\n  background: #f56c6c;\r\n  border-color: #f56c6c;\r\n}\r\n\r\n:deep(.el-button--danger:hover) {\r\n  background: #e64242;\r\n  border-color: #e64242;\r\n}\r\n\r\n/* Markdown 样式 */\r\n:deep(.markdown-body) {\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif;\r\n}\r\n\r\n:deep(.markdown-body h1),\r\n:deep(.markdown-body h2),\r\n:deep(.markdown-body h3),\r\n:deep(.markdown-body h4),\r\n:deep(.markdown-body h5),\r\n:deep(.markdown-body h6) {\r\n  margin-top: 24px;\r\n  margin-bottom: 16px;\r\n  font-weight: 600;\r\n  line-height: 1.25;\r\n}\r\n\r\n:deep(.markdown-body p) {\r\n  margin-top: 0;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n:deep(.markdown-body code) {\r\n  padding: 0.2em 0.4em;\r\n  margin: 0;\r\n  font-size: 85%;\r\n  background-color: rgba(27,31,35,0.05);\r\n  border-radius: 3px;\r\n}\r\n\r\n:deep(.markdown-body pre) {\r\n  padding: 16px;\r\n  overflow: auto;\r\n  font-size: 85%;\r\n  line-height: 1.45;\r\n  background-color: #f6f8fa;\r\n  border-radius: 3px;\r\n}\r\n\r\n:deep(.markdown-body blockquote) {\r\n  padding: 0 1em;\r\n  color: #6a737d;\r\n  border-left: 0.25em solid #dfe2e5;\r\n  margin: 0 0 16px 0;\r\n}\r\n\r\n:deep(.markdown-body img) {\r\n  max-width: 100%;\r\n  box-sizing: content-box;\r\n  background-color: #fff;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}