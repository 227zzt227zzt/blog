{"ast":null,"code":"import { createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"article-content-container\"\n};\nconst _hoisted_2 = {\n  class: \"article-header\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"article-actions\"\n};\nconst _hoisted_4 = {\n  class: \"article-main\"\n};\nconst _hoisted_5 = {\n  class: \"article-title\"\n};\nconst _hoisted_6 = {\n  class: \"article-meta\"\n};\nconst _hoisted_7 = {\n  class: \"meta-item\"\n};\nconst _hoisted_8 = {\n  class: \"meta-item\"\n};\nconst _hoisted_9 = {\n  class: \"meta-item\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"article-cover\"\n};\nconst _hoisted_11 = {\n  class: \"image-placeholder\"\n};\nconst _hoisted_12 = [\"innerHTML\"];\nconst _hoisted_13 = {\n  class: \"article-footer\"\n};\nconst _hoisted_14 = {\n  key: 0,\n  class: \"article-tags\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_image = _resolveComponent(\"el-image\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n    class: \"back-button\",\n    onClick: $setup.goBack\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"ArrowLeft\"])]),\n    _: 1 /* STABLE */\n  }), _cache[0] || (_cache[0] = _createTextVNode(\" 返回列表 \"))]), $setup.isAuthor ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: $setup.goToEdit\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Edit\"])]),\n      _: 1 /* STABLE */\n    }), _cache[1] || (_cache[1] = _createTextVNode(\" 编辑文章 \"))]),\n    _: 1 /* STABLE */,\n    __: [1]\n  }), _createVNode(_component_el_button, {\n    type: \"danger\",\n    onClick: $setup.handleDelete\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Delete\"])]),\n      _: 1 /* STABLE */\n    }), _cache[2] || (_cache[2] = _createTextVNode(\" 删除文章 \"))]),\n    _: 1 /* STABLE */,\n    __: [2]\n  })])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h1\", _hoisted_5, _toDisplayString($setup.article.title), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"span\", _hoisted_7, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"User\"])]),\n    _: 1 /* STABLE */\n  }), _createTextVNode(\" \" + _toDisplayString($setup.article.author?.username || '未知作者'), 1 /* TEXT */)]), _createElementVNode(\"span\", _hoisted_8, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"Calendar\"])]),\n    _: 1 /* STABLE */\n  }), _createTextVNode(\" \" + _toDisplayString($setup.formatDate($setup.article.createTime)), 1 /* TEXT */)]), _createElementVNode(\"span\", _hoisted_9, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode($setup[\"View\"])]),\n    _: 1 /* STABLE */\n  }), _createTextVNode(\" \" + _toDisplayString($setup.article.viewCount || 0) + \" 阅读 \", 1 /* TEXT */)])]), $setup.article.coverImage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_createVNode(_component_el_image, {\n    src: 'http://localhost8082/' + $setup.article.coverImage,\n    fit: \"cover\",\n    \"preview-src-list\": [$setup.article.coverImage]\n  }, {\n    error: _withCtx(() => [_createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_el_icon, null, {\n      default: _withCtx(() => [_createVNode($setup[\"Picture\"])]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"src\", \"preview-src-list\"])])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", {\n    class: \"article-body markdown-body\",\n    innerHTML: $setup.renderedContent\n  }, null, 8 /* PROPS */, _hoisted_12)]), _createElementVNode(\"div\", _hoisted_13, [$setup.article.tags && $setup.article.tags.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.article.tags, tag => {\n    return _openBlock(), _createBlock(_component_el_tag, {\n      key: tag.id,\n      class: \"tag\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(tag.name), 1 /* TEXT */)]),\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onClick","$setup","goBack","_createVNode","_component_el_icon","isAuthor","_hoisted_3","_component_el_button","type","goToEdit","handleDelete","_hoisted_4","_hoisted_5","_toDisplayString","article","title","_hoisted_6","_hoisted_7","author","username","_hoisted_8","formatDate","createTime","_hoisted_9","viewCount","coverImage","_hoisted_10","_component_el_image","src","fit","error","_withCtx","_hoisted_11","innerHTML","renderedContent","_hoisted_13","tags","length","_hoisted_14","_Fragment","_renderList","tag","_createBlock","_component_el_tag","key","id","name"],"sources":["C:\\Users\\52291\\Desktop\\test\\blog\\blog\\blog-frontend\\src\\views\\article\\ArticleContentView.vue"],"sourcesContent":["<template>\r\n  <div class=\"article-content-container\">\r\n    <div class=\"article-header\">\r\n      <div class=\"back-button\" @click=\"goBack\">\r\n        <el-icon><ArrowLeft /></el-icon>\r\n        返回列表\r\n      </div>\r\n      <div class=\"article-actions\" v-if=\"isAuthor\">\r\n        <el-button type=\"primary\" @click=\"goToEdit\">\r\n          <el-icon><Edit /></el-icon>\r\n          编辑文章\r\n        </el-button>\r\n        <el-button type=\"danger\" @click=\"handleDelete\">\r\n          <el-icon><Delete /></el-icon>\r\n          删除文章\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"article-main\">\r\n      <h1 class=\"article-title\">{{ article.title }}</h1>\r\n      \r\n      <div class=\"article-meta\">\r\n        <span class=\"meta-item\">\r\n          <el-icon><User /></el-icon>\r\n          {{ article.author?.username || '未知作者' }}\r\n        </span>\r\n        <span class=\"meta-item\">\r\n          <el-icon><Calendar /></el-icon>\r\n          {{ formatDate(article.createTime) }}\r\n        </span>\r\n        <span class=\"meta-item\">\r\n          <el-icon><View /></el-icon>\r\n          {{ article.viewCount || 0 }} 阅读\r\n        </span>\r\n      </div>\r\n\r\n      <div class=\"article-cover\" v-if=\"article.coverImage\">\r\n        <el-image \r\n          :src=\"'http://localhost8082/'+article.coverImage\" \r\n          fit=\"cover\"\r\n          :preview-src-list=\"[article.coverImage]\"\r\n        >\r\n          <template #error>\r\n            <div class=\"image-placeholder\">\r\n              <el-icon><Picture /></el-icon>\r\n            </div>\r\n          </template>\r\n        </el-image>\r\n      </div>\r\n\r\n      <div class=\"article-body markdown-body\" v-html=\"renderedContent\"></div>\r\n    </div>\r\n\r\n    <div class=\"article-footer\">\r\n      <div class=\"article-tags\" v-if=\"article.tags && article.tags.length\">\r\n        <el-tag \r\n          v-for=\"tag in article.tags\" \r\n          :key=\"tag.id\"\r\n          class=\"tag\"\r\n        >\r\n          {{ tag.name }}\r\n        </el-tag>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"ArticleContentView\">\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useUserStore } from '@/store/user'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { ArrowLeft, Edit, Delete, User, Calendar, View, Picture } from '@element-plus/icons-vue'\r\nimport { getArticleById, deleteArticle } from '@/api/article'\r\nimport { marked } from 'marked'\r\nimport DOMPurify from 'dompurify'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst userStore = useUserStore()\r\n\r\nconst article = ref({})\r\nconst loading = ref(false)\r\n\r\nconst isAuthor = computed(() => {\r\n  return userStore.userInfo && article.value.authorId === userStore.userInfo.id\r\n})\r\n\r\nconst renderedContent = computed(() => {\r\n  if (!article.value.content) return ''\r\n  const rawHtml = marked(article.value.content)\r\n  return DOMPurify.sanitize(rawHtml)\r\n})\r\n\r\nconst loadArticle = async () => {\r\n  try {\r\n    loading.value = true\r\n    const result = await getArticleById(route.params.id)\r\n    if (result.code === 200) {\r\n      article.value = result.data\r\n      console.log('获取文章:', article.value)\r\n    } \r\n    else {\r\n      ElMessage.error(result.message || '获取文章失败')\r\n      router.push('/articles')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取文章失败:', error)\r\n    ElMessage.error('获取文章失败')\r\n    router.push('/articles')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst formatDate = (date) => {\r\n  if (!date) return ''\r\n  return new Date(date).toLocaleDateString('zh-CN', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  })\r\n}\r\n\r\nconst goBack = () => {\r\n  router.push('/articles')\r\n}\r\n\r\nconst goToEdit = () => {\r\n  router.push(`/article/edit/${article.value.id}`)\r\n}\r\n\r\nconst handleDelete = async () => {\r\n  try {\r\n    await ElMessageBox.confirm(\r\n      '确定要删除这篇文章吗？此操作不可恢复。',\r\n      '警告',\r\n      {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }\r\n    )\r\n    \r\n    const result = await deleteArticle(article.value.id)\r\n    if (result.code === 200) {\r\n      ElMessage.success('删除成功')\r\n      router.push('/articles')\r\n    } else {\r\n      ElMessage.error(result.message || '删除失败')\r\n    }\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      console.error('删除文章失败:', error)\r\n      ElMessage.error('删除失败')\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  loadArticle()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.article-content-container {\r\n  max-width: 900px;\r\n  margin: 40px auto;\r\n  padding: 0 20px;\r\n}\r\n\r\n.article-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.back-button {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  color: #666;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: color 0.3s;\r\n}\r\n\r\n.back-button:hover {\r\n  color: #6e8efb;\r\n}\r\n\r\n.article-actions {\r\n  display: flex;\r\n  gap: 12px;\r\n}\r\n\r\n.article-main {\r\n  background: white;\r\n  border-radius: 12px;\r\n  padding: 40px;\r\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.article-title {\r\n  font-size: 32px;\r\n  font-weight: 700;\r\n  color: #333;\r\n  margin-bottom: 20px;\r\n  line-height: 1.4;\r\n}\r\n\r\n.article-meta {\r\n  display: flex;\r\n  gap: 20px;\r\n  margin-bottom: 30px;\r\n  color: #666;\r\n  font-size: 14px;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n}\r\n\r\n.article-cover {\r\n  margin: 30px -40px;\r\n  height: 400px;\r\n  overflow: hidden;\r\n}\r\n\r\n.article-cover .el-image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.image-placeholder {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #f5f7fa;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #909399;\r\n  font-size: 48px;\r\n}\r\n\r\n.article-body {\r\n  margin-top: 40px;\r\n  line-height: 1.8;\r\n  color: #333;\r\n}\r\n\r\n.article-footer {\r\n  margin-top: 40px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #eee;\r\n}\r\n\r\n.article-tags {\r\n  display: flex;\r\n  gap: 8px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.tag {\r\n  background: #f5f7fa;\r\n  border: none;\r\n  color: #666;\r\n}\r\n\r\n:deep(.el-button--primary) {\r\n  background: #6e8efb;\r\n  border-color: #6e8efb;\r\n}\r\n\r\n:deep(.el-button--primary:hover) {\r\n  background: #5a7de0;\r\n  border-color: #5a7de0;\r\n}\r\n\r\n:deep(.el-button--danger) {\r\n  background: #f56c6c;\r\n  border-color: #f56c6c;\r\n}\r\n\r\n:deep(.el-button--danger:hover) {\r\n  background: #e64242;\r\n  border-color: #e64242;\r\n}\r\n\r\n/* Markdown 样式 */\r\n:deep(.markdown-body) {\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif;\r\n}\r\n\r\n:deep(.markdown-body h1),\r\n:deep(.markdown-body h2),\r\n:deep(.markdown-body h3),\r\n:deep(.markdown-body h4),\r\n:deep(.markdown-body h5),\r\n:deep(.markdown-body h6) {\r\n  margin-top: 24px;\r\n  margin-bottom: 16px;\r\n  font-weight: 600;\r\n  line-height: 1.25;\r\n}\r\n\r\n:deep(.markdown-body p) {\r\n  margin-top: 0;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n:deep(.markdown-body code) {\r\n  padding: 0.2em 0.4em;\r\n  margin: 0;\r\n  font-size: 85%;\r\n  background-color: rgba(27,31,35,0.05);\r\n  border-radius: 3px;\r\n}\r\n\r\n:deep(.markdown-body pre) {\r\n  padding: 16px;\r\n  overflow: auto;\r\n  font-size: 85%;\r\n  line-height: 1.45;\r\n  background-color: #f6f8fa;\r\n  border-radius: 3px;\r\n}\r\n\r\n:deep(.markdown-body blockquote) {\r\n  padding: 0 1em;\r\n  color: #6a737d;\r\n  border-left: 0.25em solid #dfe2e5;\r\n  margin: 0 0 16px 0;\r\n}\r\n\r\n:deep(.markdown-body img) {\r\n  max-width: 100%;\r\n  box-sizing: content-box;\r\n  background-color: #fff;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}